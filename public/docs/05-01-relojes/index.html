<!DOCTYPE html>
<html lang="es-ar" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Relojes
  #

En un sistema centralizado x = timestamp(); y = timestamp() da como resultado \( x \leq y \).
En un sistema distribuido, acordar en un valor temporal no es trivial.
¿Es posible sincronizar los relojes de los nodos de un sistema distribuido? La respuesta es sorprendentemente complicada.
Entonces&hellip; ¿Cómo coordinan sus actividades los procesos de un sistema distribuido?

  Relojes físicos
  #

Existen situaciones donde es necesario que todos los nodos en un sistema acuerden en un valor de tiempo determinado.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/05-01-relojes/">
  <meta property="og:site_name" content="Sistemas Distribuidos">
  <meta property="og:title" content="Relojes">
  <meta property="og:description" content=" Relojes # En un sistema centralizado x = timestamp(); y = timestamp() da como resultado \( x \leq y \).
En un sistema distribuido, acordar en un valor temporal no es trivial.
¿Es posible sincronizar los relojes de los nodos de un sistema distribuido? La respuesta es sorprendentemente complicada.
Entonces… ¿Cómo coordinan sus actividades los procesos de un sistema distribuido?
Relojes físicos # Existen situaciones donde es necesario que todos los nodos en un sistema acuerden en un valor de tiempo determinado.">
  <meta property="og:locale" content="es_ar">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2024-09-18T23:05:01-03:00">
    <meta property="article:modified_time" content="2024-09-18T23:05:01-03:00">
<title>Relojes | Sistemas Distribuidos</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="canonical" href="http://localhost:1313/docs/05-01-relojes/">
<link rel="stylesheet" href="/book.min.4964903a822a7acb10dac6d1ab524833c97fb5f99b141976bcb8a47d539be9c0.css" integrity="sha256-SWSQOoIqessQ2sbRq1JIM8l/tfmbFBl2vLikfVOb6cA=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.d416c9d38ecfd95697ee7ede0664dfae369b47f77fb75f4865b25420a898aba0.js" integrity="sha256-1BbJ047P2VaX7n7eBmTfrjabR/d/t19IZbJUIKiYq6A=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]                  
    }
  };
</script>
<link rel="stylesheet" href="/logical-clocks.css">

</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Sistemas Distribuidos</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/01-introduccion/" class="">Introducción</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/02-arquitectura/" class="">Arquitecturas</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/03-procesos/" class="">Procesos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/04-01-protocolos/" class="">Protocolos de comunicación</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/04-02-rpc/" class="">RPC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/04-comunicacion-mom/" class="">MoM</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/04-comunicacion-multicast/" class="">Multicast</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/05-01-relojes/" class="active">Relojes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/05-02-mutex/" class="">Mutex</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/05-03-eleccion/" class="">Algoritmos de elección</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/05-04-agregacion/" class="">Coordinación mediante rumores</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/06-nombres-intro/" class="">Nombres, identificadores y direcciones</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/06-nombres-planos/" class="">Nombres planos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/06-nombres-planos-chord/" class="">Chord</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/07-replicacion/07-01-replicacion/" class="">Replicacion</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/07-replicacion/07-02-replicacion/" class="">Consistencia</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Relojes</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#relojes-físicos">Relojes físicos</a>
      <ul>
        <li><a href="#utc">UTC</a></li>
        <li><a href="#sincronización-de-relojes">Sincronización de relojes</a></li>
        <li><a href="#ntp">NTP</a></li>
        <li><a href="#ambientes-inalambricos">Ambientes inalambricos:</a></li>
      </ul>
    </li>
    <li><a href="#relojes-lógicos">Relojes lógicos</a>
      <ul>
        <li><a href="#relación-_happened-before_">Relación <em>happened-before</em></a></li>
        <li><a href="#diseño">Diseño</a></li>
        <li><a href="#implementación">Implementación</a></li>
        <li><a href="#ejemplo">Ejemplo</a></li>
        <li><a href="#multicast-totalmente-ordenado">Multicast totalmente ordenado</a></li>
      </ul>
    </li>
    <li><a href="#relojes-vectoriales">Relojes vectoriales</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="relojes">
  Relojes
  <a class="anchor" href="#relojes">#</a>
</h1>
<p>En un sistema centralizado <code>x = timestamp(); y = timestamp()</code> da como resultado \( x \leq y \).</p>
<p>En un sistema distribuido, acordar en un valor temporal no es trivial.</p>
<p>¿Es posible sincronizar los relojes de los nodos de un sistema distribuido? La respuesta es sorprendentemente complicada.</p>
<p>Entonces&hellip; ¿Cómo coordinan sus actividades los procesos de un sistema distribuido?</p>
<h2 id="relojes-físicos">
  Relojes físicos
  <a class="anchor" href="#relojes-f%c3%adsicos">#</a>
</h2>
<p>Existen situaciones donde es necesario que todos los nodos en un sistema acuerden en un valor de tiempo determinado.</p>
<p>Un reloj físico presenta <em>deriva</em></p>
<p>Problemas:</p>
<ol>
<li>¿Cómo sincronizamos el reloj interno con un reloj externo?</li>
<li>¿Cómo sincronizamos los relojes internos entre sí?</li>
</ol>
<h3 id="utc">
  UTC
  <a class="anchor" href="#utc">#</a>
</h3>
<p>Coordinated Universal Time: estándar internacional</p>
<p>40 emisoras de onda corta difunden una señal al comienzo de cada segundo UTC</p>
<ul>
<li>Precisión $\pm 1$ ms a $\pm 10$ ms</li>
</ul>
<p>Uso de satelites, por ejemplo GPS y relojes atómicos</p>
<ul>
<li>Precisión $\pm 0,5$ ms</li>
</ul>
<h3 id="sincronización-de-relojes">
  Sincronización de relojes
  <a class="anchor" href="#sincronizaci%c3%b3n-de-relojes">#</a>
</h3>
<p>Suponer un conjunto de nodos:</p>
<ul>
<li>Desafio 1: que esten sincronizados con una referencia externa, por ejemplo UTC.</li>
<li>Desafio 2: que los relojes de los nodos difieran lo menos posible.</li>
</ul>
<p><strong>Exactitud</strong>: mantener la desviación con respecto a una <em>fuente externa</em> dentro de un rango específico.
<strong>Precisión</strong>: mantener la desviación entre dos relojes dentro de un rango específico.</p>
<p>Sincronización externa: mantener los relojes <em>exactos</em>.</p>
<p>Sincronización interna: mantener los relojes <em>precisos</em>.</p>
<p>Problema:</p>
<ul>
<li>Los relojes fisicos no son exactos, presentan deriva</li>
<li>El reloj por software se basa en el reloj hardware</li>
<li>Segun la deriva un reloj puede ser más rapido o más lento en referencia a un reloj ideal</li>
</ul>
<p>Fun facts:</p>
<ul>
<li>Dos relojes exactos pueden ser precisos con una cota $2 \delta$</li>
<li>Sin embargo, ser precisos <strong>no indica</strong> nada acerca de la exactitud.</li>
</ul>
<p>Servidor de tiempo:</p>
<ul>
<li>Obtener un valor actualizado desde un servidor central (por ejemplo, que tenga un reloj UTC)</li>
<li>Implementación mediante una arquitectura cliente/servidor:
<ul>
<li>Servidor retorna al cliente respuesta con timestamp.</li>
<li>Cliente debe compensar el <em>offset</em> y <em>delay</em>.</li>
</ul>
</li>
</ul>
<h3 id="ntp">
  NTP
  <a class="anchor" href="#ntp">#</a>
</h3>
<p>Network Time Protocol</p>
<h3 id="ambientes-inalambricos">
  Ambientes inalambricos:
  <a class="anchor" href="#ambientes-inalambricos">#</a>
</h3>
<p>Requieren algoritmos diferentes</p>
<p>Ejemplo: Reference Broadcast Synchronization</p>
<h2 id="relojes-lógicos">
  Relojes lógicos
  <a class="anchor" href="#relojes-l%c3%b3gicos">#</a>
</h2>
<p>Generalmente lo que importa es que los nodos esten de acuerdo en el <em>orden</em> de los eventos.</p>
<h3 id="relación-_happened-before_">
  Relación <em>happened-before</em>
  <a class="anchor" href="#relaci%c3%b3n-_happened-before_">#</a>
</h3>
<ul>
<li>$a$ y $b$ son eventos</li>
<li>Si $a$ ocurre antes que $b$ en un mismo proceso, entonces $a \rightarrow b$</li>
<li>Si $a$ es el envío de un mensaje y $b$ la recepción, entonces $a \rightarrow b$</li>
<li>Transitivo: si $a \rightarrow b$ y $b \rightarrow c$, entonces $a \rightarrow c$</li>
<li>Introduce un <strong>ordenamiento parcial</strong> sobre los eventos.</li>
</ul>
<h3 id="diseño">
  Diseño
  <a class="anchor" href="#dise%c3%b1o">#</a>
</h3>
<ul>
<li>Cada evento $e$ tiene asociado un timestamp $C(e)$</li>
<li>Propiedad 1: si $a$ y $b$ son eventos en un mismo proceso y $a \rightarrow b$ entonces $C(a) &lt; C(b)$</li>
<li>Propiedad 2: si $a$ y $b$ son envío y recepción de un mensaje respectivamente, entonces $C(a) &lt; C(b)$</li>
</ul>
<h3 id="implementación">
  Implementación
  <a class="anchor" href="#implementaci%c3%b3n">#</a>
</h3>
<ul>
<li>Cada proceso $P_i$ mantiene un reloj lógico $C_i$</li>
<li>Por cada evento en $P_i$, $C_i = C_i + 1$</li>
<li>Cada mensaje enviado por <em>Pi</em> tiene un timestamp <em>ts(m)</em> = <em>C(i)</em></li>
<li>Cuando <em>Pj</em> recibe un mensaje <em>m</em>:
<ul>
<li>Ajusta su contador <em>Cj</em> con el máximo valor entre <em>Cj</em> y <em>ts(m)</em></li>
<li>Antes de pasar el mensaje a la aplicación, incrementa <em>Cj</em> en uno.</li>
</ul>
</li>
</ul>
<p>El servicio de relojes lógicos es implementado en un middleware, idealmente la aplicación no tiene por que ocuparse.</p>
<h3 id="ejemplo">
  Ejemplo
  <a class="anchor" href="#ejemplo">#</a>
</h3>
<div id="container1">
  <div id="container2">
    <svg id="lc-svg" width="600" height="400"></svg>
  </div>
  <button id="send1to2">P1 envía a P2</button>
  <button id="send2to3">P2 envía a P3</button>
  <button id="send3to1">P3 envía a P1</button>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="/logical-clocks.js"></script>
</div>

<h3 id="multicast-totalmente-ordenado">
  Multicast totalmente ordenado
  <a class="anchor" href="#multicast-totalmente-ordenado">#</a>
</h3>
<p>Es posible realizar un multicas totalmente ordenado mediante el uso de relojes lógicos:w</p>
<h2 id="relojes-vectoriales">
  Relojes vectoriales
  <a class="anchor" href="#relojes-vectoriales">#</a>
</h2>
<p>Al usar relojes lógicos si $C(a) &lt; C(b)$ no implica que $a$ ocurra antes que $b$</p>
<p>Solución: relojes vectoriales</p>
<ul>
<li>Cada nodo mantiene su propio reloj lógico</li>
<li>Mantiene información de los relojes lógicos del resto de los nodos</li>
<li>Se organizan como un vector o arreglo
<ul>
<li>$V[i]$ es el reloj lógico del nodo $i$</li>
<li>$V[j]$ es el reloj lógico del nodo $j$</li>
</ul>
</li>
</ul>
<p>Ahora el timestamp asociado a cada mensaje es un vector: <em>ts(m)</em> = <em>VC</em></p>
<p>Para comparar dos relojes vectoriales, <em>VCa</em> &lt; <em>VCb</em> si y solo si:</p>
<ul>
<li><em>VCa[k]</em> &lt;= <em>VCb[k]</em> para cualquier <em>k</em></li>
<li>existe al menos un k&rsquo; tal que <em>VCa[k&rsquo;]</em> &lt; <em>VCb[k&rsquo;]</em></li>
</ul>
<p>Si se cumple <em>VCa</em> &lt; <em>VCb</em> entonces un evento precede causalmente a otro.</p>
<p>Implementación: similar al reloj lógico</p>
<p>Ejemplo de uso: multicast totalmente ordenado.</p>
<div id="container1">
  <div id="container2" style="overflow-x: auto; white-space: nowrap;">
    <svg id="vc-svg" width="800" height="400"></svg>
  </div>

  <div>
    <label for="sender">Emisor:</label>
    <select id="sender">
      <option value="P1">P1</option>
      <option value="P2">P2</option>
      <option value="P3">P3</option>
    </select>

    <label for="receiver">Receptor:</label>
    <select id="receiver">
      <option value="P1">P1</option>
      <option value="P2">P2</option>
      <option value="P3">P3</option>
    </select>

    <button id="sendMessageBtn">Enviar Mensaje</button>
  </div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="/js/vector-clocks.js"></script>
</div>

</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#relojes-físicos">Relojes físicos</a>
      <ul>
        <li><a href="#utc">UTC</a></li>
        <li><a href="#sincronización-de-relojes">Sincronización de relojes</a></li>
        <li><a href="#ntp">NTP</a></li>
        <li><a href="#ambientes-inalambricos">Ambientes inalambricos:</a></li>
      </ul>
    </li>
    <li><a href="#relojes-lógicos">Relojes lógicos</a>
      <ul>
        <li><a href="#relación-_happened-before_">Relación <em>happened-before</em></a></li>
        <li><a href="#diseño">Diseño</a></li>
        <li><a href="#implementación">Implementación</a></li>
        <li><a href="#ejemplo">Ejemplo</a></li>
        <li><a href="#multicast-totalmente-ordenado">Multicast totalmente ordenado</a></li>
      </ul>
    </li>
    <li><a href="#relojes-vectoriales">Relojes vectoriales</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












